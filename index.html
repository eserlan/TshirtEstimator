<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T-shirt Estimator</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<main class="container">
    <h1 id="mainTitle">üëï T-shirt Estimator</h1>

    <!-- Setup View -->
    <section id="setupView">
        <article>
            <h2>Start a New Session</h2>
            <form id="createSessionForm">
                <label for="taskDescription">
                    Task Description
                    <input type="text" id="taskDescription" name="taskDescription"
                           placeholder="Enter the task to estimate" required>
                </label>
                <label for="participantNames">
                    Participants (comma-separated)
                    <input type="text" id="participantNames" name="participantNames" placeholder="Alice, Bob, Charlie"
                           required>
                </label>
                <label for="estimationType">
                    Estimation Scale
                    <select id="estimationType" name="estimationType">
                        <option value="tshirt" selected>T-shirt Sizes</option>
                        <option value="fibonacci">Planning Poker (Fibonacci)</option>
                    </select>
                </label>
                <button type="submit">Create Session</button>
            </form>
        </article>

        <article>
            <h2>Join Existing Session</h2>
            <form id="joinSessionForm">
                <label for="sessionId">
                    Session ID
                    <input type="text" id="sessionId" name="sessionId" placeholder="Enter session ID" required>
                </label>
                <button type="submit">Join Session</button>
            </form>
        </article>
    </section>

    <!-- Estimation View -->
    <section id="estimationView" class="hidden">
        <button id="backButton" class="secondary outline">‚Üê Back to Setup</button>

        <article>
            <header>
                <h2 id="taskTitle">Task: Loading...</h2>
            </header>
            <p class="session-id-display">
                Session ID: <strong id="currentSessionId"></strong>
            </p>
            <p class="participant-name-display">
                Participant: <strong id="currentParticipantName"></strong>
            </p>
        </article>

        <article id="welcomeBanner" class="welcome-banner hidden">
            <header>
                <h3>üëã Welcome, <span id="welcomeParticipantName"></span>!</h3>
            </header>
            <p id="welcomeMessage">Ready to estimate? Make your selection below.</p>
        </article>

        <article id="yourEstimationSection">
            <header>
                <h3>Your Estimation</h3>
            </header>
            <div class="estimation-panel">
                <p id="estimationPrompt" class="estimation-prompt">Select your T-shirt size estimate:</p>
                <div id="estimationButtons" class="estimation-buttons">
                    <!-- Estimation buttons will be injected here -->
                </div>
            </div>
            <div id="yourEstimateDisplay" class="your-estimate-display hidden">
                <div class="estimate-result">
                    <strong id="yourEstimate"></strong>
                </div>
            </div>
        </article>


        <article>
            <header>
                <h3>Participants Status</h3>
            </header>
            <div id="participantsList" class="participant-list">
                <!-- Participants will be dynamically added here -->
            </div>
        </article>


    </section>

    <section>
        <article id="resultsSection" class="hidden">
            <header>
                <h3>üìä Results</h3>
            </header>
            <p class="info-message">
                All participants have submitted their estimates!
            </p>

            <!-- Average Size Visualization -->
            <div id="averageSizeSection" class="average-size-section">
                <h4 id="averageEstimateHeading"><span id="averageEstimateLabel">Average Estimate</span>: <span id="averageSize"></span></h4>
                <svg id="sizesVisualization" class="sizes-svg" viewBox="0 0 700 400" xmlns="http://www.w3.org/2000/svg">
                    <!-- Size distribution bars will be dynamically added here -->
                </svg>
                <div id="sizeLegend" class="size-legend"></div>
            </div>

            <footer>
                <button id="joinSessionButton" class="secondary">‚ûï Join Session</button>
            </footer>
        </article>

        <aside id="waitingSection" class="hidden">
            <p class="warning-message">
                ‚è≥ Waiting for all participants to submit their estimates...
            </p>
        </aside>
    </section>
</main>

<!-- Participant Selection Modal -->
<dialog id="participantModal">
    <article>
        <header>
            <h3>Select Your Name</h3>
        </header>
        <p>Choose your participant name from the list below:</p>
        <div id="participantButtonList" class="participant-button-list">
            <!-- Participant buttons will be dynamically added here -->
        </div>
    </article>
</dialog>

<script type="module" src="app.js"></script>
</body>
</html>
